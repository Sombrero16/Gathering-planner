<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resource Gathering Optimizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-select, .form-input {
            background-color: #2d3748; /* bg-gray-700 */
        }
        /* Hide number input spinners */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-4 sm:p-6 lg:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- The header now uses flexbox for better spacing and alignment -->
        <header class="text-center mb-8 flex items-center justify-center space-x-6">
            <img src="https://raw.githubusercontent.com/Sombrero16/Gathering-planner/main/assets/pictures/image02.jpg" alt="Decorative image" class="w-24 h-24 sm:w-32 sm:h-32 rounded-full border-2 border-cyan-400">
            <div>
                <h1 class="text-3xl sm:text-4xl font-bold text-cyan-400">Resource Gathering Optimizer</h1>
                <p class="text-xs sm:text-sm text-white-400 font-medium italic mt-2"><a href="./curra.html" class="text-white no-underline">C</a>ourtesy of S16</p>
                <p class="text-gray-400 mt-2">Find the optimal gathering plan to maximize your final bonus.</p>
            </div>
            <img src="https://raw.githubusercontent.com/Sombrero16/Gathering-planner/main/assets/pictures/image01.jpg" alt="Decorative image" class="w-24 h-24 sm:w-32 sm:h-32 rounded-full border-2 border-cyan-400">
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Left Panel: Settings -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-6 border-b border-gray-700 pb-3">1. Calculator Settings</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="select-march" class="block text-sm font-medium text-gray-300 mb-1">Select March</label>
                        <select id="select-march" class="form-select w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50"></select>
                    </div>
                    <div>
                        <label for="select-center" class="block text-sm font-medium text-gray-300 mb-1">Select Resource Center</label>
                        <select id="select-center" class="form-select w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50"></select>
                    </div>
                    <div>
                        <label for="select-global-speed" class="block text-sm font-medium text-gray-300 mb-1">Global Speed Buff</label>
                        <select id="select-global-speed" class="form-select w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50"></select>
                    </div>
                    <div>
                        <label for="select-load-bonus" class="block text-sm font-medium text-gray-300 mb-1">Load Bonus</label>
                        <select id="select-load-bonus" class="form-select w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50"></select>
                    </div>
                    <div>
                        <label for="time-at-center" class="block text-sm font-medium text-gray-300 mb-1">Time at Resource Center (HH:MM)</label>
                        <input type="text" id="time-at-center" value="22:30" class="form-input w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50">
                    </div>
                    <div>
                        <label for="select-civilization" class="block text-sm font-medium text-gray-300 mb-1">Civilization</label>
                        <select id="select-civilization" class="form-select w-full border-gray-600 text-white rounded-md shadow-sm focus:border-cyan-500 focus:ring focus:ring-cyan-500 focus:ring-opacity-50">
                            <option value="other">Other</option>
                            <option value="byzantines">Byzantines</option>
                            <option value="egyptian">Egyptian</option>
                        </select>
                        <p id="byzantines-notice" class="text-xs text-gray-400 mt-1 hidden">Note: Byzantinian civilization provides a 5% stone gathering speed bonus.</p>
                        <p id="egyptian-notice" class="text-xs text-gray-400 mt-1 hidden">Note: Egyptian civilization provides a 5% troop load bonus.</p>
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Chief Elder Title</label>
                        <label class="flex items-center space-x-2 text-sm cursor-pointer">
                            <input type="checkbox" id="imperial-title" class="form-checkbox h-4 w-4 bg-gray-700 border-gray-600 rounded text-cyan-500 focus:ring-cyan-600">
                            <span class="text-gray-300">Enabled</span>
                        </label>
                    </div>
                </div>

                <h2 class="text-xl font-semibold mt-8 mb-4 border-b border-gray-700 pb-3">Node Status</h2>
                <div id="nodes-table" class="space-y-3">
                    <!-- Node checkboxes will be generated here -->
                </div>

                <h2 class="text-xl font-semibold mt-8 mb-4 border-b border-gray-700 pb-3">Edit Your Stats</h2>
                <div class="space-y-4">
                    <h3 class="text-lg font-medium text-gray-200">Marches</h3>
                    <div id="march-editor" class="space-y-3"></div>
                    <h3 class="text-lg font-medium text-gray-200 mt-4">Resource Speeds</h3>
                    <div id="resource-editor" class="space-y-3"></div>
                </div>
            </div>

            <!-- Right Panel: Results -->
            <div class="lg:col-span-2 bg-gray-800 p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold mb-6 border-b border-gray-700 pb-3">2. Your Optimal Plan</h2>
                <div id="results-container" class="space-y-4">
                    <!-- Results will be generated here -->
                </div>
            </div>
        </div>
    </div>

<script>
    // --- DATA CONFIGURATION ---
    const config = {
        marches: [
            { id: 1, name: 'March 1', speedBonus: 1.65, finalBonus: 0.52, baseLoad: 16700000 },
            { id: 2, name: 'March 2', speedBonus: 2.90, finalBonus: 0.44, baseLoad: 21300000 },
            { id: 3, name: 'March 3', speedBonus: 2.86, finalBonus: 0.56, baseLoad: 20600000 },
            { id: 4, name: 'March 4', speedBonus: 2.38, finalBonus: 0.45, baseLoad: 16000000 },
            { id: 5, name: 'March 5', speedBonus: 2.08, finalBonus: 0.53, baseLoad: 20600000 }
        ],
        resources: [
            { name: 'Wood', speedBonus: 0.24 },
            { name: 'Food', speedBonus: 0.14 },
            { name: 'Stone', speedBonus: 0.17 },
            { name: 'Gold', speedBonus: 0.24 }
        ],
        globalSpeeds: [
            { name: 'No Global', speedBonus: 0.00 },
            { name: 'One Global', speedBonus: 0.10 },
            { name: 'Two Globals', speedBonus: 0.20 }
        ],
        loadBonuses: [
            { name: '0% Bonus', bonus: 0.00 },
            { name: '10% Bonus', bonus: 0.10 },
            { name: '20% Bonus', bonus: 0.20 },
            { name: '30% Bonus', bonus: 0.30 }
        ],
        centerNodes: [
            { id: 'rc_wood', name: 'Resource Center (Wood)', baseSpeed: 250000, capacity: 800000000, repeatable: false, available: true },
            { id: 'rc_food', name: 'Resource Center (Food)', baseSpeed: 250000, capacity: 800000000, repeatable: false, available: true },
            { id: 'rc_stone', name: 'Resource Center (Stone)', baseSpeed: 250000, capacity: 800000000, repeatable: false, available: true },
            { id: 'rc_gold', name: 'Resource Center (Gold)', baseSpeed: 250000, capacity: 800000000, repeatable: false, available: true },
        ],
        nodes: [
            { name: 'T6 Rich', baseSpeed: 420000, capacity: 12600000, available: true, repeatable: false },
            { name: 'T6', baseSpeed: 210000, capacity: 3780000, available: true, repeatable: true },
            { name: 'T5', baseSpeed: 200000, capacity: 2160000, available: true, repeatable: true },
            { name: 'T4', baseSpeed: 190000, capacity: 912000, available: true, repeatable: true }
        ]
    };

    // --- DOM ELEMENTS ---
    const UIElements = {
        marchSelect: document.getElementById('select-march'),
        centerSelect: document.getElementById('select-center'),
        globalSpeedSelect: document.getElementById('select-global-speed'),
        loadBonusSelect: document.getElementById('select-load-bonus'),
        timeAtCenterInput: document.getElementById('time-at-center'),
        nodesTable: document.getElementById('nodes-table'),
        resultsContainer: document.getElementById('results-container'),
        marchEditor: document.getElementById('march-editor'),
        resourceEditor: document.getElementById('resource-editor'),
        imperialTitle: document.getElementById('imperial-title'),
        civilizationSelect: document.getElementById('select-civilization'),
        egyptianNotice: document.getElementById('egyptian-notice'),
        byzantinesNotice: document.getElementById('byzantines-notice')
    };

    // --- INITIALIZATION ---
    function init() {
        populateSelect(UIElements.marchSelect, config.marches, 'name', 'id');
        populateSelect(UIElements.centerSelect, config.centerNodes, 'name', 'id');
        populateSelect(UIElements.globalSpeedSelect, config.globalSpeeds, 'name', 'speedBonus');
        populateSelect(UIElements.loadBonusSelect, config.loadBonuses, 'name', 'bonus');
        populateNodes();
        populateEditors();
        
        // Add event listeners
        Object.values(UIElements).forEach(el => {
            if (el && (el.tagName === 'SELECT' || el.tagName === 'INPUT')) {
                el.addEventListener('change', calculatePlan);
            }
        });
        UIElements.timeAtCenterInput.addEventListener('keyup', calculatePlan);

        // Initial calculation
        calculatePlan();
    }

    function populateSelect(selectElement, items, nameKey, valueKey) {
        selectElement.innerHTML = '';
        items.forEach(item => {
            const option = document.createElement('option');
            option.textContent = item[nameKey];
            option.value = item[valueKey];
            selectElement.appendChild(option);
        });
    }

    function populateNodes() {
        UIElements.nodesTable.innerHTML = '';
        
        // T6 Rich Toggle
        const t6RichNode = config.nodes.find(n => n.name === 'T6 Rich');
        const t6RichIndex = config.nodes.findIndex(n => n.name === 'T6 Rich');
        if (t6RichNode) {
            const nodeDiv = document.createElement('div');
            nodeDiv.className = 'flex items-center justify-between bg-gray-700 p-2 rounded-md';
            const t6ToggleHTML = `
                <label class="flex items-center space-x-2 text-xs cursor-pointer">
                    <input type="checkbox" data-index="${t6RichIndex}" data-type="available" class="form-checkbox h-4 w-4 bg-gray-800 border-gray-600 rounded text-cyan-500 focus:ring-cyan-600" ${t6RichNode.available ? 'checked' : ''}>
                    <span>Available</span>
                </label>
            `;
            nodeDiv.innerHTML = `
                <span class="font-medium">${t6RichNode.name}</span>
                <div class="flex items-center space-x-4 h-6">${t6ToggleHTML}</div>
            `;
            UIElements.nodesTable.appendChild(nodeDiv);
            
            nodeDiv.querySelector('input[type="checkbox"]').addEventListener('change', (e) => {
                config.nodes[t6RichIndex].available = e.target.checked;
                calculatePlan();
            });
        }
        
        // Resource Center Toggle
        const centerDiv = document.createElement('div');
        centerDiv.className = 'flex items-center justify-between bg-gray-700 p-2 rounded-md';
        const centerIsRepeatable = config.centerNodes[0]?.repeatable || false; // State is shared across all center types
        const centerToggleHTML = `
            <label class="flex items-center space-x-2 text-xs cursor-pointer">
                <input type="checkbox" id="center-repeatable-toggle" class="form-checkbox h-4 w-4 bg-gray-800 border-gray-600 rounded text-cyan-500 focus:ring-cyan-600" ${centerIsRepeatable ? 'checked' : ''}>
                <span>Repeatable</span>
            </label>
        `;
        centerDiv.innerHTML = `
            <span class="font-medium">Resource Center</span>
            <div class="flex items-center space-x-4 h-6">${centerToggleHTML}</div>
        `;
        UIElements.nodesTable.appendChild(centerDiv);

        document.getElementById('center-repeatable-toggle').addEventListener('change', (e) => {
            const isChecked = e.target.checked;
            config.centerNodes.forEach(node => node.repeatable = isChecked);
            calculatePlan();
        });
    }

    function populateEditors() {
        // March Editor
        UIElements.marchEditor.innerHTML = '';
        config.marches.forEach((march, index) => {
            const marchDiv = document.createElement('div');
            marchDiv.className = 'p-3 bg-gray-700 rounded-md';
            marchDiv.innerHTML = `
                <p class="font-bold text-white mb-2">${march.name}</p>
                <div class="grid grid-cols-3 gap-2 text-xs">
                    <div>
                        <label class="block text-gray-400">Speed %</label>
                        <input type="number" value="${march.speedBonus * 100}" data-index="${index}" data-prop="speedBonus" class="form-input w-full p-1 rounded-sm">
                    </div>
                    <div>
                        <label class="block text-gray-400">Bonus %</label>
                        <input type="number" value="${march.finalBonus * 100}" data-index="${index}" data-prop="finalBonus" class="form-input w-full p-1 rounded-sm">
                    </div>
                    <div>
                        <label class="block text-gray-400">Load</label>
                        <input type="number" value="${march.baseLoad}" data-index="${index}" data-prop="baseLoad" class="form-input w-full p-1 rounded-sm">
                    </div>
                </div>
            `;
            UIElements.marchEditor.appendChild(marchDiv);
        });

        // Resource Editor
        UIElements.resourceEditor.innerHTML = '';
        config.resources.forEach((resource, index) => {
            const resourceDiv = document.createElement('div');
            resourceDiv.className = 'flex items-center justify-between bg-gray-700 p-2 rounded-md';
            resourceDiv.innerHTML = `
                <label class="text-gray-300 font-medium">${resource.name}</label>
                <div class="flex items-center space-x-2">
                    <input type="number" value="${resource.speedBonus * 100}" data-index="${index}" data-prop="speedBonus" class="form-input w-24 p-1 rounded-sm text-center">
                    <span class="text-gray-400">%</span>
                </div>
            `;
            UIElements.resourceEditor.appendChild(resourceDiv);
        });

        // Add event listeners for new inputs
        UIElements.marchEditor.querySelectorAll('input').forEach(input => {
            input.addEventListener('change', (e) => {
                const index = e.target.dataset.index;
                const prop = e.target.dataset.prop;
                let value = parseFloat(e.target.value);
                if (prop !== 'baseLoad') {
                    value /= 100; // Convert from percentage
                }
                config.marches[index][prop] = value;
                calculatePlan();
            });
        });

        UIElements.resourceEditor.querySelectorAll('input').forEach(input => {
            input.addEventListener('change', (e) => {
                const index = e.target.dataset.index;
                const prop = e.target.dataset.prop;
                const value = parseFloat(e.target.value) / 100;
                config.resources[index][prop] = value;
                calculatePlan();
            });
        });
    }

    // --- CALCULATION LOGIC ---
    function calculatePlan() {
        // Handle UI toggles
        if (UIElements.civilizationSelect.value === 'egyptian') {
            UIElements.egyptianNotice.classList.remove('hidden');
            UIElements.byzantinesNotice.classList.add('hidden');
        } else if (UIElements.civilizationSelect.value === 'byzantines') {
            UIElements.byzantinesNotice.classList.remove('hidden');
            UIElements.egyptianNotice.classList.add('hidden');
        } else {
            UIElements.byzantinesNotice.classList.add('hidden');
            UIElements.egyptianNotice.classList.add('hidden');
        }

        // 1. Get current values
        const selectedMarch = config.marches.find(m => m.id == UIElements.marchSelect.value);
        if (!selectedMarch) return;
        
        const selectedCenterId = UIElements.centerSelect.value;
        const centerNode = config.centerNodes.find(n => n.id === selectedCenterId);
        if (!centerNode) return;

        // Create a temporary copy of resources to apply civilization bonus
        let currentResources = JSON.parse(JSON.stringify(config.resources));
        if (UIElements.civilizationSelect.value === 'byzantines') {
            const stone = currentResources.find(r => r.name === 'Stone');
            if (stone) {
                stone.speedBonus += 0.05;
            }
        }

        // Determine optimal resource for PREFILL nodes using the potentially modified resource list
        const optimalResource = currentResources.reduce((max, res) => res.speedBonus > max.speedBonus ? res : max, currentResources[0]);
        const optimalResourceName = optimalResource.name;
        
        // Determine the SPECIFIC resource bonus for the SELECTED CENTER
        const centerResourceName = selectedCenterId.split('_')[1]; // 'wood' from 'rc_wood'
        const centerResource = currentResources.find(r => r.name.toLowerCase() === centerResourceName) || currentResources[0];
        
        const globalSpeedBonus = parseFloat(UIElements.globalSpeedSelect.value);
        const imperialTitleBonus = UIElements.imperialTitle.checked ? 0.10 : 0;
        const loadBonus = parseFloat(UIElements.loadBonusSelect.value);
        const timeParts = UIElements.timeAtCenterInput.value.split(':').map(Number);
        const timeAtCenterHours = (timeParts[0] || 0) + ((timeParts[1] || 0) / 60);

        // 2. Core Calculations
        const finalMarchLoad = selectedMarch.baseLoad * (1 + loadBonus);
        
        const totalCenterSpeedBonus = selectedMarch.speedBonus + centerResource.speedBonus + globalSpeedBonus + imperialTitleBonus;
        const totalSpeedAtCenter = centerNode.baseSpeed * (1 + totalCenterSpeedBonus);
        
        const optimalAmountFromCenter = Math.min(finalMarchLoad, totalSpeedAtCenter * timeAtCenterHours);
        const actualTimeToFillCenterHours = optimalAmountFromCenter > 0 ? optimalAmountFromCenter / totalSpeedAtCenter : 0;
        
        const loadToPrefill = finalMarchLoad - optimalAmountFromCenter;
        let tempAmountToPrefill = loadToPrefill > 0 ? loadToPrefill / (1 + selectedMarch.finalBonus) : 0;


        // 3. Generate Pre-fill Plan
        let potentialPrefillNodes = [...config.nodes];
        if (centerNode.repeatable) {
            potentialPrefillNodes.push(centerNode);
        }

        const availablePrefillNodes = potentialPrefillNodes
            .filter(n => n.available)
            .map(n => ({...n, effectiveCapacity: n.capacity }))
            .sort((a, b) => b.baseSpeed - a.baseSpeed);
        
        let prefillPlan = [];
        
        while (tempAmountToPrefill > 0.1) {
            let nodeFoundThisLoop = false;
            for (const node of availablePrefillNodes) {
                const capacity = node.repeatable ? node.capacity : node.effectiveCapacity;
                if (capacity > 0.1) {
                    const amountToTake = Math.min(tempAmountToPrefill, capacity);
                    
                    const isCenterTypeNode = config.centerNodes.some(cn => cn.name === node.name);
                    const prefillNodeResource = isCenterTypeNode ? centerResource : optimalResource;
                    
                    const totalDynamicPrefillSpeedBonus = selectedMarch.speedBonus + prefillNodeResource.speedBonus + globalSpeedBonus + imperialTitleBonus;

                    const effectiveSpeed = node.baseSpeed * (1 + totalDynamicPrefillSpeedBonus);
                    const timeNeededHours = amountToTake / effectiveSpeed;
                    const bonusFromStep = amountToTake * selectedMarch.finalBonus;

                    prefillPlan.push({
                        name: node.name,
                        amount: amountToTake,
                        bonus: bonusFromStep,
                        time: timeNeededHours
                    });
                    
                    tempAmountToPrefill -= amountToTake;

                    if (!node.repeatable) {
                        node.effectiveCapacity -= amountToTake;
                    }
                    nodeFoundThisLoop = true;
                    break; 
                }
            }
            if (!nodeFoundThisLoop) break;
        }

        // 4. Final results object
        const bonusFromCenter = optimalAmountFromCenter * selectedMarch.finalBonus;
        const totalPrefillGatheredLoad = prefillPlan.reduce((sum, step) => sum + step.amount, 0);
        const totalPrefillBonusGained = prefillPlan.reduce((sum, step) => sum + step.bonus, 0);
        const totalLoadFilled = totalPrefillGatheredLoad + totalPrefillBonusGained + optimalAmountFromCenter;
        
        const results = {
            marchName: selectedMarch.name,
            finalMarchLoad,
            prefillPlan,
            centerPlan: {
                name: centerNode.name,
                amount: optimalAmountFromCenter,
                bonus: bonusFromCenter,
                time: actualTimeToFillCenterHours
            },
            totalResources: totalLoadFilled + bonusFromCenter,
            bonusResources: totalPrefillBonusGained + bonusFromCenter,
            optimalResourceName: optimalResourceName
        };

        renderResults(results);
    }
    
    // --- RENDER RESULTS ---
    function renderResults(results) {
        UIElements.resultsContainer.innerHTML = '';

        function formatNumber(num) {
            return Math.round(num).toLocaleString();
        }

        function formatTime(hours) {
            if (!isFinite(hours)) return '00:00:00';
            const totalSeconds = hours * 3600;
            const h = Math.floor(totalSeconds / 3600).toString().padStart(2, '0');
            const m = Math.floor((totalSeconds % 3600) / 60).toString().padStart(2, '0');
            const s = Math.floor(totalSeconds % 60).toString().padStart(2, '0');
            return `${h}:${m}:${s}`;
        }

        let html = '<div class="space-y-6">';

        // Prefill steps
        if (results.prefillPlan.length > 0) {
            results.prefillPlan.forEach((step, index) => {
                html += `
                    <div class="bg-gray-700/50 p-4 rounded-lg">
                        <p class="text-cyan-400 font-semibold">Step ${index + 1}: Pre-fill</p>
                        <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm">
                            <div><strong>Node:</strong> <span class="text-gray-300">${step.name}</span></div>
                            <div><strong>Gather Amount:</strong> <span class="text-gray-300">${formatNumber(step.amount)}</span></div>
                            <div><strong>Bonus Gained:</strong> <span class="text-green-400 font-medium">+${formatNumber(step.bonus)}</span></div>
                            <div><strong>Est. Time:</strong> <span class="text-gray-300">${formatTime(step.time)}</span></div>
                        </div>
                    </div>
                `;
            });
        }
        
        // Center step
        html += `
            <div class="bg-gray-700/50 p-4 rounded-lg">
                <p class="text-cyan-400 font-semibold">Step ${results.prefillPlan.length + 1}: Final Gather</p>
                <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm">
                    <div><strong>Node:</strong> <span class="text-gray-300">${results.centerPlan.name}</span></div>
                    <div><strong>Gather Amount:</strong> <span class="text-gray-300">${formatNumber(results.centerPlan.amount)}</span></div>
                    <div><strong>Bonus Gained:</strong> <span class="text-green-400 font-medium">+${formatNumber(results.centerPlan.bonus)}</span></div>
                    <div><strong>Time to Fill:</strong> <span class="text-gray-300">${formatTime(results.centerPlan.time)}</span></div>
                </div>
            </div>
        `;

        // Summary
        html += `
            <div class="border-t border-gray-700 pt-6 mt-6">
                <h3 class="text-xl font-semibold text-white mb-4">Summary</h3>
                <div class="space-y-2 text-base bg-gray-900/50 p-4 rounded-lg">
                     <div class="flex justify-between">
                        <span class="text-gray-400">Optimal Pre-fill Resource:</span>
                        <span class="font-bold text-white">${results.optimalResourceName}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Total Resources Gathered (incl. bonus):</span>
                        <span class="font-bold text-green-400">${formatNumber(results.totalResources)}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Target March Load:</span>
                        <span class="font-medium text-gray-300">${formatNumber(results.finalMarchLoad)}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Total Bonus Resources Gained:</span>
                        <span class="font-medium text-cyan-400">+ ${formatNumber(results.bonusResources)}</span>
                    </div>
                </div>
            </div>
        `;
        
        html += '</div>';
        UIElements.resultsContainer.innerHTML = html;
    }

    // --- START THE APP ---
    document.addEventListener('DOMContentLoaded', init);

</script>

</body>
</html>
